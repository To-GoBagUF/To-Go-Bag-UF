<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8">
<title>To-Go Bag UF</title>
<style>
  body { font-family: Arial, sans-serif; background:white; margin:0; padding:0; color:#001f3f; }
  button { transition: all 0.3s ease; cursor:pointer; }
  button:hover { transform: scale(1.05); box-shadow:0 6px 12px rgba(0,0,0,0.3); }
  select { transition: all 0.2s ease; padding:6px; border-radius:6px; border:1px solid #001f3f; margin-bottom:10px; }
  select:hover { border-color:#0056a0; }
  #cartIcon { position:fixed; top:20px; right:20px; font-size:24px; background:#001f3f; color:white; padding:12px 16px; border-radius:50%; box-shadow:0 4px 6px rgba(0,0,0,0.3); transition: transform 0.2s; }
  #cartIcon:hover { transform:scale(1.1); }
  #cartModal, #checkoutModal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000; opacity:0; pointer-events:none; transition: opacity 0.4s ease; }
  .modalContent { background:white; padding:30px; border-radius:12px; max-width:500px; width:90%; position:relative; box-shadow:0 8px 20px rgba(0,0,0,0.5); transform:translateY(-50px); transition: transform 0.4s ease; }
  .modalOpen { opacity:1; pointer-events:auto; }
  .modalOpen .modalContent { transform:translateY(0); }
  .closeBtn { position:absolute; top:10px; right:15px; font-size:24px; cursor:pointer; transition: color 0.2s; }
  .closeBtn:hover { color:#ff0000; }
  input[type="text"], input[type="email"], input[type="number"] { width:100%; padding:10px; margin-bottom:8px; border-radius:6px; border:1px solid #001f3f; }
  h2 { color:#001f3f; text-align:center; margin-bottom:15px; }
</style>
</head>
<body>

<div style="margin:20px;">
  <label for="variantSelect" style="font-weight:bold;">Variant:</label>
  <select id="variantSelect">
    <option value="Pad/Tampon">Pad/Tampon</option>
    <option value="Male">Male</option>
  </select>

  <div id="subVariantContainer" style="margin-top:10px;">
    <label for="subVariantSelect" style="font-weight:bold;">V칛lj produkt:</label>
    <select id="subVariantSelect">
      <option value="Pad">Pad</option>
      <option value="Tampon">Tampon</option>
    </select>
  </div>

  <div style="margin-top:10px;">
    <label for="colorSelect" style="font-weight:bold;">F칛rg:</label>
    <select id="colorSelect">
      <option value="Bl친">Bl친</option>
      <option value="Rosa">Rosa</option>
      <option value="Svart">Svart</option>
      <option value="Vit">Vit</option>
    </select>
  </div>

  <button id="orderBtn" style="margin-top:15px; padding:12px 24px; background-color:#001f3f; color:white; border:none; border-radius:10px; font-size:18px;">L칛gg i varukorg</button>
</div>

<div id="cartIcon">游 <span id="cartCount">0</span></div>

<div id="cartModal">
  <div class="modalContent">
    <span id="closeCart" class="closeBtn">&times;</span>
    <h2>Din varukorg</h2>
    <div id="cartContent"></div>
  </div>
</div>

<div id="checkoutModal">
  <div class="modalContent">
    <span id="closeCheckout" class="closeBtn">&times;</span>
    <h2>Slutf칬r best칛llning</h2>
    <form id="checkout-form">
      <input type="text" id="name" placeholder="Namn" required>
      <input type="email" id="email" placeholder="E-post" required>
      <input type="text" id="phone" placeholder="Telefonnummer" required>
      <input type="text" id="address" placeholder="Adress" required>
      <input type="text" id="postal" placeholder="Postnummer" required>
      <input type="text" id="city" placeholder="Stad" required>

      <label for="shipping">Fraktmetod:</label>
      <select id="shipping">
        <option value="Standard">Standard</option>
        <option value="Express">Express</option>
      </select>

      <label for="variant">Variant:</label>
      <select id="variant">
        <option value="Pad/Tampon">Pad/Tampon</option>
        <option value="Male">Male</option>
      </select>

      <label for="subVariant">Produktval:</label>
      <select id="subVariant">
        <option value="Pad">Pad</option>
        <option value="Tampon">Tampon</option>
      </select>

      <label for="color">F칛rg:</label>
      <select id="color">
        <option value="Bl친">Bl친</option>
        <option value="Rosa">Rosa</option>
        <option value="Svart">Svart</option>
        <option value="Vit">Vit</option>
      </select>

      <label for="quantityCheckout">Antal:</label>
      <input type="number" id="quantityCheckout" value="1" min="1">

      <button type="button" onclick="sendShippingAndPay()" style="width:100%; padding:12px; background-color:#001f3f; color:white; border:none; border-radius:10px; font-size:16px;">Slutf칬r k칬p</button>
    </form>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
emailjs.init("ZUlGUNzP7Tqxg-LkD");

let cart = 0;

document.getElementById('variantSelect').addEventListener('change', function() {
  document.getElementById('subVariantContainer').style.display = (this.value === 'Pad/Tampon') ? 'block' : 'none';
});

function openModal(id){ document.getElementById(id).classList.add('modalOpen'); }
function closeModal(id){ document.getElementById(id).classList.remove('modalOpen'); }

document.getElementById('orderBtn').onclick = function() {
  cart = 1;
  const selectedVariant = document.getElementById('variantSelect').value;
  let selectedSubVariant = '';
  if(selectedVariant==='Pad/Tampon') selectedSubVariant = document.getElementById('subVariantSelect').value;
  const selectedColor = document.getElementById('colorSelect').value;
  document.getElementById('cartCount').innerText = cart;

  document.getElementById('cartContent').innerHTML = `
    <p>The To-Go Bag - 85kr</p>
    <p>Variant: ${selectedVariant}${selectedSubVariant?' ('+selectedSubVariant+')':''}</p>
    <p>F칛rg: ${selectedColor}</p>
    <label for="cartQuantity">Antal:</label>
    <input type="number" id="cartQuantity" value="1" min="1">
    <p>Total: <span id="cartTotal">85</span>kr</p>
    <button id="proceedCheckout">F칬rbest칛ll / Checkout</button>
  `;

  openModal('cartModal');

  const cartQuantityInput = document.getElementById('cartQuantity');
  const cartTotalSpan = document.getElementById('cartTotal');

  cartQuantityInput.addEventListener('input', function() {
    let quantity = parseInt(cartQuantityInput.value);
    if(isNaN(quantity) || quantity < 1) quantity = 1;
    cartQuantityInput.value = quantity;
    cartTotalSpan.innerText = 85 * quantity;
  });

  document.getElementById('proceedCheckout').onclick = function() {
    const quantity = parseInt(cartQuantityInput.value) || 1;
    document.getElementById('variant').value = selectedVariant;
    document.getElementById('subVariant').value = selectedSubVariant;
    document.getElementById('color').value = selectedColor;
    document.getElementById('quantityCheckout').value = quantity;
    closeModal('cartModal');
    openModal('checkoutModal');
  }
};

document.getElementById('cartIcon').onclick = function() {
  if(cart>0) openModal('cartModal'); else alert("Din varukorg 칛r tom.");
}

document.getElementById('closeCart').onclick = ()=>closeModal('cartModal');
document.getElementById('closeCheckout').onclick = ()=>closeModal('checkoutModal');

function sendShippingAndPay(){
  const name = document.getElementById('name').value;
  const email = document.getElementById('email').value;
  const phone = document.getElementById('phone').value;
  const address = document.getElementById('address').value;
  const postal = document.getElementById('postal').value;
  const city = document.getElementById('city').value;
  const shipping = document.getElementById('shipping').value;
  const variant = document.getElementById('variant').value;
  const subVariant = document.getElementById('subVariant').value;
  const color = document.getElementById('color').value;
  const quantity = parseInt(document.getElementById('quantityCheckout').value)||1;
  const total = quantity*85;

  emailjs.send("service_obk5jf2","template_kj9rgm7",{
    name,email,phone,address,postal,city,shipping,variant,subVariant,color,quantity,total
  }).then(()=>{
    const modalContent = document.querySelector('#checkoutModal .modalContent');
    modalContent.innerHTML = `
      <span id="closeCheckout" class="closeBtn">&times;</span>
      <h2>Tack f칬r din best칛llning!</h2>
      <p><strong>Namn:</strong> ${name}</p>
      <p><strong>E-post:</strong> ${email}</p>
      <p><strong>Telefon:</strong> ${phone}</p>
      <p><strong>Adress:</strong> ${address}, ${postal} ${city}</p>
      <p><strong>Fraktmetod:</strong> ${shipping}</p>
      <p><strong>Produkt:</strong> ${variant} ${subVariant} - ${color}</p>
      <p><strong>Antal:</strong> ${quantity}</p>
      <p><strong>Total:</strong> ${total}kr</p>
      <p>칐ppna Swish p친 mobilen f칬r att betala.</p>
    `;
    document.getElementById('closeCheckout').onclick = ()=>closeModal('checkoutModal');

    if(/Mobi|Android/i.test(navigator.userAgent)){
      const swishURL=`swish://paymentrequest?token=1&callbackurl=https://togobaguf.com&payee=0764134947&amount=${total}&message=To-Go%20Bag%20(${variant},${subVariant},${color},%20f칬rbest칛llning)`;
      window.location.href = swishURL;
    } else {
      alert("Swish fungerar endast p친 mobilen. 칐ppna sidan p친 mobilen f칬r att betala.");
    }
  }, e=>{alert("Det gick inte att skicka adressen."); console.log(e);});
}
</script>
</body>
</html>

